@let copyList = slidesCopy();
@let copyActive = activeCopy();

<section
  class="mg-section"
  [attr.aria-label]="ariaSectionLabel() || 'Sekcja startowa'"
>
  <div class="mg-container">
    <div
      class="mg-hero__wrap"
      (mouseenter)="onMouseEnter()"
      (mouseleave)="onMouseLeave()"
      (focusin)="onFocusIn()"
      (focusout)="onFocusOut()"
    >
      <div class="mg-hero__media mg-card">
        <div class="mg-hero__stage">
          <img
            class="mg-hero__img"
            [src]="active().imageSrc"
            [alt]="active().imageAlt"
            loading="eager"
            decoding="async"
          />

          <a
            class="mg-hero__stretched-link"
            [routerLink]="active().ctaPath"
            [attr.aria-label]="(copyActive?.ctaLabel || '') + ': ' + (copyActive?.heading || '')"
          ></a>

          <div class="mg-hero__overlay" aria-hidden="true"></div>

          <div class="mg-hero__caption">
            <div class="flex-row-between flex-col-sm">
              <div
                class="mg-section__title mg-section__title--sm mg-section__title--no-margin truncate-2"
              >
                {{ copyActive?.heading }}
              </div>

              <p-button
                class="mg-hero__caption-btn"
                [label]="copyActive?.ctaLabel"
                icon="pi pi-arrow-right"
                iconPos="right"
                severity="primary"
                size="small"
                [routerLink]="active().ctaPath"
              />
            </div>

            <p class="mg-hero__caption-text truncate-2">
              {{ copyActive?.text }}
            </p>
          </div>

          <div class="mg-hero__controls flex-row-between">
            <p-button
              type="button"
              icon="pi pi-chevron-left"
              severity="secondary"
              size="small"
              [text]="true"
              (onClick)="prev()"
              [ariaLabel]="ariaPrev() || 'Poprzedni slajd'"
            />

            <div
              class="flex-row-center"
              role="tablist"
              [attr.aria-label]="ariaDots() || 'Wybór slajdu'"
            >
              @for (s of slides(); track trackByIndex($index)) {
                <button
                  type="button"
                  class="mg-hero__dot"
                  [class.is-active]="$index === activeIndex()"
                  (click)="goTo($index)"
                  [attr.aria-label]="dotAriaLabel(ariaGoToPrefix() || 'Przejdź do slajdu', $index)"
                  [attr.aria-current]="$index === activeIndex() ? 'true' : null"
                ></button>
              }
            </div>

            <p-button
              type="button"
              icon="pi pi-chevron-right"
              severity="secondary"
              size="small"
              [text]="true"
              (onClick)="next()"
              [ariaLabel]="ariaNext() || 'Następny slajd'"
            />
          </div>
        </div>
      </div>

      <div class="mg-hero__content">
        <header class="mg-section__header">
          <h1 class="mg-section__title">{{ copyActive?.heading }}</h1>

          <p class="mg-section__subtitle mg-hero__subtitle truncate-2">
            {{ copyActive?.text }}
          </p>
        </header>

        <div class="mg-hero__cta-grid">
          @for (s of slides(); track trackByCtaPath($index, s)) {
            @let copy = (copyList?.[$index] ?? null);

            <div
              class="mg-card mg-hero__cta"
              role="link"
              tabindex="0"
              (click)="onCtaNavigate(s.ctaPath)"
              (keydown)="onCtaKeydown($event, s.ctaPath)"
              [attr.aria-label]="copy?.heading"
            >
              <div class="mg-section__title mg-section__title--xs mg-section__title--no-margin">
                {{ copy?.heading }}
              </div>

              <p class="truncate-3">
                {{ copy?.text }}
              </p>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</section>
