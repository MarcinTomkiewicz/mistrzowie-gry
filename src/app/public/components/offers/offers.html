<!-- path: src/app/features/offers/offers.html -->
<section class="mg-section">
  <div class="mg-container">
    @if (pageVm(); as data) {
      <header class="mg-section__header">
        <h1 class="mg-section__title">{{ data.page.title }}</h1>
        <p class="mg-section__subtitle">{{ data.page.subtitle }}</p>
      </header>

      <!-- HERO -->
      @if (data.hero; as s) {
        <div class="mg-card mb-lg">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          <div class="flex-row-start gap-sm mt-md">
            <p-button
              [label]="commonCta().contactUs"
              icon="pi pi-envelope"
              severity="primary"
              routerLink="/contact"
            />
          </div>
        </div>
      }

      <!-- PRICING TABLE -->
      @if (data.pricing; as s) {
        <div class="mg-card mb-lg">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          <p-table [value]="s.items" [stripedRows]="true" [tableStyle]="{ 'width': '100%' }">
            <ng-template pTemplate="header">
              <tr>
                <th>{{ pricingHeaders().variant }}</th>
                <th>{{ pricingHeaders().price }}</th>
                <th>{{ pricingHeaders().description }}</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-it>
              <tr>
                <td>{{ it.title }}</td>
                <td>{{ formatPricing(it.pricing) }}</td>
                <td>{{ it.lead }}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      }

      <!-- ADDONS -->
      @if (data.addon; as s) {
        <div class="mb-lg">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          <div class="mg-offer-cards">
            @for (it of s.items; track it.id) {
              <div class="mg-card">
                <div class="mg-section__title mg-section__title--sm">{{ it.title }}</div>

                @if (formatAddonPricing(it.pricing); as p) {
                  <div class="mg-section__title mg-section__title--xs">{{ p.value }}</div>
                  @if (p.note) {
                    <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ p.note }}</p>
                  }
                }

                <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ it.lead }}</p>
              </div>
            }
          </div>
        </div>
      }

      <!-- MATERIALS -->
      @if (data.material; as s) {
        <div class="mb-lg">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          <div class="mg-offer-cards">
            @for (it of s.items; track it.id) {
              <div class="mg-card">
                <div class="mg-section__title mg-section__title--sm">{{ it.title }}</div>

                @if (formatPricingDetailed(it.pricing); as p) {
                  <div class="mg-section__title mg-section__title--xs">{{ p.value }}</div>
                  @if (p.note) {
                    <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ p.note }}</p>
                  }
                }

                <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ it.lead }}</p>
              </div>
            }
          </div>
        </div>
      }

      <!-- FAQ -->
      @if (data.faq.section; as s) {
        <div class="mg-card mb-lg">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          @if (data.faq.items.length) {
            <p-accordion>
              @for (x of data.faq.items; let i = $index; track i) {
                <p-accordion-panel [value]="i">
                  <p-accordion-header class="mg-section__title mg-section__title--xs">
                    {{ x.h }}
                  </p-accordion-header>
                  <p-accordion-content>{{ x.a }}</p-accordion-content>
                </p-accordion-panel>
              }
            </p-accordion>
          } @else {
            <div class="mg-card">
              <div class="mg-section__title mg-section__title--sm">{{ commonEmpty().title }}</div>
              <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ commonEmpty().description }}</p>
            </div>
          }
        </div>
      }

      <!-- CTA -->
      @if (data.cta; as s) {
        <div class="mg-card">
          @if (s.title) { <h2 class="mg-section__title mg-section__title--sm">{{ s.title }}</h2> }
          @if (s.subtitle) { <p class="mg-section__subtitle mg-section__subtitle--no-margin">{{ s.subtitle }}</p> }

          <div class="flex-row-start gap-sm mt-md">
            <p-button
              [label]="commonCta().contactUs"
              icon="pi pi-envelope"
              severity="success"
              routerLink="/contact"
            />
          </div>
        </div>
      }
    } @else {
      <div class="mg-card">
        <p>{{ commonStatus().loading }}</p>
      </div>
    }
  </div>
</section>